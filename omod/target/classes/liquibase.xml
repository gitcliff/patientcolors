<?xml version="1.1" encoding="UTF-8"?>
 
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
 
    <!--
    	See http://wiki.openmrs.org/display/docs/Module+liquibase+File for 
    	documentation on this file.
    
        See http://www.liquibase.org/manual/home#available_database_refactorings
        for a list of supported elements and attributes
    -->
    
	<changeSet author="cliff" id="201608021221" >
		<comment>Creating the patient_colors table</comment>
		<createTable tableName="patient_colors">
			<column autoIncrement="true" name="patient_colors_id" type="int" >
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="name" type="varchar(255)" />
		</createTable>
	</changeSet>
	<changeSet author="cliff" id="201608021222" >
		<comment>Adding patient_id to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="patient_id" type="int" />
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021223" >
		<comment>Adding patient_name to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="patient_name" type="varchar(255)" />
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021224" >
		<comment>Adding  uuid to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="uuid" type="varchar(38)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="cliff" id="201608021225">
		<comment>Adding void_reason to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="void_reason" type="varchar(255)"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021226">
		<comment>Adding voided to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="voided" type="boolean" defaultValueBoolean="false"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021227">
		<comment>Adding date_voided to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="date_voided" type="DATETIME"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="201608021229" author="cliff">
		<preConditions>
			<columnExists tableName="patient_colors" columnName="uuid"/>
		</preConditions>
		<comment>Adding unique constraint uuid to table patient_colors</comment>
		<addUniqueConstraint tableName="patient_colors" columnNames="uuid"/>
	</changeSet>
	
	<changeSet id="201608021210" author="cliff">
		<comment>Adding a foreign key constraint patient_id to table patient_colors</comment>
		<addForeignKeyConstraint baseColumnNames="patient_id" baseTableName="patient_colors" constraintName="patient_colors_patient_id_fk" deferrable="false" initiallyDeferred="false" referencedColumnNames="patient_id" referencedTableName="patient"/>
	</changeSet>
	<changeSet id="201608021211" author="cliff">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="patient_colors" columnName="voided_by" />
        </preConditions>
        <comment>Dropping voided_by column from patient_colors table
        </comment>
        <dropColumn tableName="patient_colors" columnName="voided_by" />
    </changeSet>
    
    <changeSet author="cliff" id="201608021211">
		<comment>Adding voided_by to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="voided_by" type="int"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021212">
		<comment>Adding changed_by to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="changed_by" type="int"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021213">
		<comment>Adding date_created to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="date_created" type="DATETIME"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021214">
		<comment>Adding date_changed to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="date_changed" type="DATETIME"/>
		</addColumn>
	</changeSet>
	<changeSet author="cliff" id="201608021215">
		<comment>Adding creator to the table patient_colors</comment>
		<addColumn tableName="patient_colors">
			<column name="creator" type="int"/>
		</addColumn>
	</changeSet>
</databaseChangeLog>